<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ranking FTMSP 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              ftmsp: {
                red: '#c62828',
                gray: '#424242',
                light: '#f5f5f5'
              }
            }
          }
        }
      }
    </script>
  </head>
  <body class="bg-ftmsp-light text-ftmsp-gray font-sans min-h-screen">
    <div id="app" class="p-6"></div>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <script type="text/babel">
      function App() {
        const [data, setData] = React.useState([]);
        const [categories, setCategories] = React.useState([]);
        const [selectedCategory, setSelectedCategory] = React.useState('');
        const [selectedAthlete, setSelectedAthlete] = React.useState(null);

        React.useEffect(() => {
          Papa.parse("ranking.csv", {
            download: true,
            header: true,
            complete: (results) => {
              setData(results.data);
              const cats = [...new Set(results.data.map((row) => row.Categoria))];
              setCategories(cats);
              setSelectedCategory(cats[0]);
            },
          });
        }, []);

        const athletes = data
          .filter((row) => row.Categoria === selectedCategory)
          .sort((a, b) => Number(b.Total) - Number(a.Total));

        return (
          <div>
            <h1 className="text-4xl font-bold text-center mb-8 text-ftmsp-red">
              Ranking FTMSP 2025
            </h1>

            <div className="flex justify-center mb-6">
              <select
                className="p-2 rounded border border-ftmsp-gray bg-white text-ftmsp-gray font-medium"
                value={selectedCategory}
                onChange={(e) => setSelectedCategory(e.target.value)}
              >
                {categories.map((cat) => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {athletes.map((ath, idx) => (
                <div
                  key={idx}
                  className="cursor-pointer bg-white shadow-lg border border-gray-300 p-4 rounded-lg hover:scale-105 transition-transform"
                  onClick={() => setSelectedAthlete(ath)}
                >
                  <h2 className="text-lg font-bold text-ftmsp-gray">{ath.Atleta}</h2>
                  <p className="text-sm text-gray-600">Clube: {ath.Clube}</p>
                  <p className="text-sm text-gray-600">Ranking: {ath.Ranking}</p>
                  <p className="text-md text-ftmsp-red font-bold">Pontos: {ath.Total}</p>
                </div>
              ))}
            </div>

            {selectedAthlete && (
              <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4">
                <div className="bg-white p-6 rounded-lg max-w-md w-full shadow-xl">
                  <h2 className="text-2xl font-bold mb-4 text-ftmsp-red">{selectedAthlete.Atleta}</h2>
                  <p className="mb-2 text-ftmsp-gray">Categoria: {selectedAthlete.Categoria}</p>
                  <div className="space-y-2">
                    {Object.keys(selectedAthlete)
                      .filter((key) => key.startsWith("Etapa"))
                      .map((etapa) => (
                        <div key={etapa} className="flex justify-between border-b pb-1 text-ftmsp-gray">
                          <span>{etapa}</span>
                          <span className="font-semibold">{selectedAthlete[etapa]}</span>
                        </div>
                      ))}
                  </div>
                  <button
                    className="mt-6 bg-ftmsp-red hover:bg-red-700 text-white px-4 py-2 rounded"
                    onClick={() => setSelectedAthlete(null)}
                  >
                    Fechar
                  </button>
                </div>
              </div>
            )}
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("app")).render(<App />);
    </script>
  </body>
</html>
